@model Mango.Web.Areas.Admin.Models.ProductLayoutFormViewModel

@{
    ViewBag.Title = "EditLayout";
}

@section ScriptsHead
{
    <script src="@Links.Scripts.product_canvas.fabric_min_js"></script>
    <style>
        canvas {
            border: 1px solid #ccc;
        }

        .pic {
            color: green;
        }

        .text {
            color: blue;
        }
        /*logo icons*/
        .icons {
            text-align: center;
            vertical-align: middle;
        }

            .icons div {
                display: inline-block;
                border: 3px solid transparent;
                margin: 2px;
                vertical-align: middle;
            }

            .icons img {
                height: auto;
                width: 100%;
                max-width: 40px;
                max-height: 40px;
                vertical-align: middle;
            }

        .active {
            border: 3px solid #7F9293 !important;
            display: inline-block;
        }
    </style>
}

<ol class="breadcrumb">
    <li>@Html.ActionLink("Home", MVC.Home.Index())</li>
    <li>@Html.ActionLink("Products", MVC.Admin.Product.List())</li>
    <li class="active">@Html.ActionLink("Layout", MVC.Admin.Product.Layout(Model.ProductId))</li>
</ol>

<h2>Product Layout</h2>

<div class="container">
    <div class="row">
        <div class=" col-sm-12">
            <p>Use this tool to specify placement of logo and text</p>
            <div class="form-horizontal">
                <div class="form-group">
                    <div class="col-md-10">
                        <a class="btn btn-info" id="btnUploadImageOpenModal">Upload Background Image</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-sm-12">
            <div class="col-md-7 ">
                <canvas id="c" name="productname" width="500" height="500"></canvas>
            </div>
            <div id="contents" class="well col-md-4 col-md-offset-0 col-sm-12"></div>

            <div class="well col-md-4 col-md-offset-0 col-sm-12">
                <input id="addPic" type="button" value="Add Pic" class="btn btn-success" />
                <input id="addText" type="button" value="Add Text" class="btn btn-primary" />
                <input id="removeObject" type="button" value="Remove" class="btn btn-danger" />
                <a id="download" name="productname">Download Test</a>
            </div>
        </div>
    </div>
</div>

@using (Html.BeginForm())
{
    @Html.AntiForgeryToken()

    @Html.HiddenFor(model => model.ProductId)

    <div class="form-horizontal">

        @Html.HiddenFor(model => model.Configuration)
        @Html.HiddenFor(model => model.CanvasImage)
    </div>
}

<div id="modalImageUpload" class="modal fade">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h4 class="modal-title">Upload Primary Logo Image</h4>
            </div>
            <div class="modal-body">
                <form action="/admin/api/fileupload" method="post" enctype="multipart/form-data">
                    <div class="form-horizontal">
                        <div class="form-group" data-upload="controls">
                            <label class="control-label col-md-2">File</label>
                            <div class="col-md-10">
                                <input type="file" data-upload="fileupload" />
                            </div>
                        </div>
                        <div data-upload="progress">
                            <img src="/content/images/ajax-loader.gif" alt="" />
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary" data-upload="upload">Upload</button>
            </div>
        </div>
    </div>
</div>


@section Scripts {
    <script src="@Links.Scripts.product_canvas.canvas_js"></script>
    <script src="@Links.Scripts.product_canvas.wordwrap_js"></script>
    <script src="@Links.Scripts.Areas.Admin.Product.Layout_js"></script>
    <script src="@Links.Scripts.Areas.Admin.Shared.UploadImage_js"></script>
    <script>
        var layoutCanvas = new LayoutCanvas({
            controlAddPic: "#addPic",
            controlAddText: "#addText",
            controlRemoveText: "#removeObject",
            controlDownload: "#download",
            inputConfiguration: "#Configuration",
            config: ""
        });
        var uploadImage = new UploadImage({
            urlDataTarget: "#CanvasImage",
            modalId: "#modalImageUpload",
            modalTrigger: "#btnUploadImageOpenModal",
            onUploaded: function (url) {
                layoutCanvas.updateCanvas(url);
            }
        });
    </script>
}
