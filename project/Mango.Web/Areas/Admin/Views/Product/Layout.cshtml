@model Mango.Web.Areas.Admin.Models.ProductLayoutFormViewModel

@{
    ViewBag.Title = "EditLayout";
}

@section ScriptsHead
{
    <script src="@Links.Scripts.Areas.Admin.Product.Layout_js"></script>
    <script>
        var imageUpload = [
            buttonUpload = "#btnUpload",
            containerControls = "#uploadControls",
            containerProgress = "#uploadProgress",
            fileUpload = "#fileUpload",
            containerResults = "#uploadResults",
            hiddenResultTarget = "#"
        ];
    </script>

    <style>
        canvas {
            border: 1px solid #ccc;
        }

        .pic {
            color: green;
        }

        .text {
            color: blue;
        }
        /*logo icons*/
        .icons {
            text-align: center;
            vertical-align: middle;
        }

            .icons div {
                display: inline-block;
                border: 3px solid transparent;
                margin: 2px;
                vertical-align: middle;
            }

            .icons img {
                height: auto;
                width: 100%;
                max-width: 40px;
                max-height: 40px;
                vertical-align: middle;
            }

        .active {
            border: 3px solid #7F9293 !important;
            display: inline-block;
        }
    </style>


}

<h2>EditLayout</h2>




<div class="container col-sm-12">

    <form action="/admin/api/fileupload" method="post" enctype="multipart/form-data">
        <div id="uploadControls">
            <div>
                <span>Select file(s) to upload :</span>
                <input id="fileUpload" type="file" />
            </div>
            <div>
                <input id="btnUpload" type="button" value="Upload" />
            </div>
            <ul id="uploadResults"></ul>
        </div>
        <div id="uploadProgress" class="hidden">
            <img src="/content/images/ajax-loader.gif" alt="" />
        </div>
    </form>


    
    Use this tool to specify placement of logo and text
    <input type="file" id="uploadImg">
    <div class="col-md-7 ">
        <canvas id="c" name="productname" width="500" height="500"></canvas>
    </div>
    <div id="contents" class="well col-md-4 col-md-offset-0 col-sm-12"></div>

    <div class="well col-md-4 col-md-offset-0 col-sm-12">
        <input id="addPic" type="button" value="Add Pic" class="btn btn-success" />
        <input id="addText" type="button" value="Add Text" class="btn btn-primary" />
        <input id="removeObject" type="button" value="Remove" class="btn btn-danger" />
        <a id="download" name="productname">Download Test</a>
    </div>
</div>

@using (Html.BeginForm())
{
    @Html.AntiForgeryToken()

    @Html.HiddenFor(model => model.ProductId)

    <div class="form-horizontal">
        <h4>ProductLayoutFormViewModel</h4>
        <hr />
        @Html.ValidationSummary(true, "", new { @class = "text-danger" })

        <div class="form-group">
            @Html.LabelFor(model => model.Configuration, new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.EditorFor(model => model.Configuration, new { htmlAttributes = new { @class = "form-control" } })
                @Html.ValidationMessageFor(model => model.Configuration, "", new { @class = "text-danger" })
            </div>
        </div>

        <div class="form-group">
            @Html.LabelFor(model => model.CanvasImage, htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.EditorFor(model => model.CanvasImage, new { htmlAttributes = new { @class = "form-control" } })
                @Html.ValidationMessageFor(model => model.CanvasImage, "", new { @class = "text-danger" })
            </div>
        </div>

        <div class="form-group">
            <div class="col-md-offset-2 col-md-10">
                <input type="submit" value="Save" class="btn btn-default" />
            </div>
        </div>
    </div>
}


@section Scripts {
    <script src="@Links.Scripts.product_canvas.canvas_js"></script>
    <script src="@Links.Scripts.product_canvas.wordwrap_js"></script>

    <script>
        (function() {
            function showUploadControls() {
                $(imageUpload.containerControls).show();
                $(imageUpload.containerProgress).hide();
            }

            function showUploadProgress() {
                $(imageUpload.containerControls).hide();
                $(imageUpload.containerProgress).show();
            }

            function onUpload(evt) {
                var files = $(imageUpload.containerResults).get(0).files;
                if (files.length > 0) {
                    showUploadProgress();

                    if (window.FormData !== undefined) {
                        var data = new FormData();
                        for (i = 0; i < files.length; i++) {
                            data.append("file" + i, files[i]);
                        }
                        $.ajax({
                            type: "POST",
                            url: "/admin/api/fileupload",
                            contentType: false,
                            processData: false,
                            data: data,
                            success: function(results) {
                                showUploadControls();
                                $(imageUpload.containerResults).empty();
                                for (i = 0; i < results.length; i++) {
                                    $(imageUpload.containerResults).append($("<li/>").text(results[i]));
                                }
                            },
                            error: function(xhr, ajaxOptions, thrownError) {
                                showUploadControls();
                                alert(xhr.responseText);
                            }
                        });
                    } else {
                        alert("Your browser doesn't support HTML5 multiple file uploads! Please use some decent browser.");
                    }
                }
            }

            $(document).ready(function() {
                $(imageUpload.buttonUpload).click(onUpload);
            });
        }).call(this);
    </script>

}
